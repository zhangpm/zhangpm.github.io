<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>Pengmiao&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Pengmiao&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Pengmiao&#39;s Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pengmiao&#39;s Blog">
  
    <link rel="alternate" href="/atom.xml" title="Pengmiao&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Pengmiao&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Linux_shell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/02/Linux_shell/" class="article-date">
  <time datetime="2019-07-02T08:22:33.017Z" itemprop="datePublished">2019-07-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/02/Linux_shell/">Linux Shell</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.bilibili.com/video/av47009997/?p=245" target="_blank" rel="noopener">https://www.bilibili.com/video/av47009997/?p=245</a></p>
<p><a href="https://www.youtube.com/watch?v=cQepf9fY6cE&amp;list=PLS1QulWo1RIYmaxcEqw5JhK3b-6rgdWO_&amp;index=1" target="_blank" rel="noopener">https://www.youtube.com/watch?v=cQepf9fY6cE&amp;list=PLS1QulWo1RIYmaxcEqw5JhK3b-6rgdWO_&amp;index=1</a></p>
<h1 id="p198-Shell基础"><a href="#p198-Shell基础" class="headerlink" title="p198 Shell基础"></a>p198 Shell基础</h1><h2 id="1-脚本执行方式"><a href="#1-脚本执行方式" class="headerlink" title="1. 脚本执行方式"></a>1. 脚本执行方式</h2><ol>
<li><p>echo 输出命令；<code>-e</code>可使用转义字符<code>\</code>，例如“\t”制表符</p>
</li>
<li><p>第一个shell程序：hello.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"Hello World"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>赋予执行权限：chmod +x hello.sh</p>
</li>
<li>运行：./hello.sh<ol>
<li>说明：运行需要相对路径或绝对路径。</li>
<li>相对路径：./代表当前目录；~/代表当前用户主目录</li>
</ol>
</li>
<li>或不用3步，直接bash ./hello.sh</li>
<li>dos2unix 命令，windows格式转化为linux格式</li>
<li>history命令：历史命令</li>
</ol>
<h2 id="2-variables"><a href="#2-variables" class="headerlink" title="2. variables"></a>2. variables</h2><ol>
<li><p><code>$</code>引用变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=Mark</span><br><span class="line"><span class="built_in">echo</span> The name is <span class="variable">$name</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>变量名不能用数字开头</p>
</li>
</ol>
<h2 id="3-Read-using-input"><a href="#3-Read-using-input" class="headerlink" title="3. Read using input"></a>3. Read using input</h2><ol>
<li><p><code>read</code>语句, <code>read name</code>输入变量赋值给name,</p>
</li>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Enter name"</span></span><br><span class="line"><span class="built_in">read</span> name1 name2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Entered names: <span class="variable">$name1</span>,<span class="variable">$name2</span>"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>多变量：<strong>空格间隔</strong>，输入也是空格间隔</p>
</li>
<li><p>read -p 带提示(prompt)的输入; <code>-sp</code> password,输入不显示字符</p>
</li>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">'username: '</span> username</span><br><span class="line"><span class="built_in">read</span> -sp <span class="string">'password: '</span>password</span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"name: <span class="variable">$username</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"pass: <span class="variable">$password</span>"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>单引号：完全按照字符输出；双引号：识别特殊符号，例如<code>$</code>符号作为变量, <code>\</code>转义字符，等</p>
</li>
<li><p>echo 空，换行</p>
</li>
<li><p><code>read -a names</code> 传入array形式. 输出用curly bracket<code>{}</code>括起来.</p>
</li>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Enter name"</span></span><br><span class="line"><span class="built_in">read</span> -a names</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Entered names: <span class="variable">$&#123;names[0]&#125;</span>,<span class="variable">$&#123;names[1]&#125;</span>"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>当变量名和后面的内容都是变量名时，是用花括号括起来避免歧义。如names 和names[0].</p>
</li>
<li><p>read默认输入变量REPLY, 因此若read 不赋值变量，则可取REPLY获取</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$REPLY</span>"</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="3-Pass-Argument"><a href="#3-Pass-Argument" class="headerlink" title="3. Pass Argument"></a>3. Pass Argument</h2><ol>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$1</span> <span class="variable">$2</span> <span class="variable">$3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行，加入参数<code>./hello.sh aaa bbb ccc</code>。第一个参数传入$1</p>
</li>
<li><p><code>$0</code> is the name of the shell script, here is <code>hello.sh</code></p>
</li>
<li><p>传入数组<code>args=(&quot;$@&quot;)</code>，第一个参数传为args[0]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">args=(<span class="string">"<span class="variable">$@</span>"</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;args[0]&#125;</span> <span class="variable">$&#123;args[1]&#125;</span> <span class="variable">$&#123;args[2]&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>参数默认传入为$@ （dollar at a rate），因此可直接输出echo \$@  </p>
</li>
<li><p>$# 为参数个数 （dollar hash）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$1</span> <span class="variable">$2</span> <span class="variable">$3</span></span><br><span class="line">args=(<span class="string">"<span class="variable">$@</span>"</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;args[0]&#125;</span> <span class="variable">$&#123;args[1]&#125;</span> <span class="variable">$&#123;args[2]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$@</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$#</span></span><br></pre></td></tr></table></figure>
<p>输出：</p>
<p>aaa bbb ccc<br>aaa bbb ccc<br>aaa bbb ccc<br>3</p>
</li>
</ol>
<h1 id="p201Shell基础"><a href="#p201Shell基础" class="headerlink" title="p201Shell基础"></a>p201Shell基础</h1><h2 id="1-别名"><a href="#1-别名" class="headerlink" title="1. 别名"></a>1. 别名</h2><ol>
<li><code>alias 别名=‘原命令’</code></li>
<li><code>alias</code> 查询别名</li>
<li>别名永久生效：<ol>
<li>vim /root/.bashrc</li>
<li>写入<code>alias 别名=‘原命令’</code></li>
</ol>
</li>
<li>删除：unalias</li>
</ol>
<h2 id="2-Bash常用快捷键"><a href="#2-Bash常用快捷键" class="headerlink" title="2. Bash常用快捷键"></a>2. Bash常用快捷键</h2><p><img src="G:\git\blog\source\_posts\pic\Bash_hot.JPG" alt="Bash_hot"></p>
<h2 id="3-输入输出重定向："><a href="#3-输入输出重定向：" class="headerlink" title="3.输入输出重定向："></a>3.输入输出重定向：</h2><ol>
<li>标准输出重定向<code>&gt;</code>覆盖；<code>&gt;&gt;</code>追加</li>
<li>标准错误输出重定向：<code>2&gt;</code>,<code>2&gt;&gt;</code></li>
<li>常用：正确错误同时保存：<code>命令 &amp;&gt;(&gt;&gt;) 文件</code></li>
<li>正误分别存 <code>命令&gt;&gt;文件1 2&gt;&gt;文件2</code></li>
<li><code>ls &amp;&gt;/dev/null</code> 输出到黑洞</li>
<li>输入重定向：<code>wc [选项][文件名]</code><ol>
<li>wc &lt; 文件</li>
</ol>
</li>
</ol>
<h2 id="4-bash基本功能"><a href="#4-bash基本功能" class="headerlink" title="4. bash基本功能"></a>4. bash基本功能</h2><ol>
<li>多命令顺序执行：如：<code>命令1;命令2</code><ol>
<li><code>；</code> 多命令顺序执行，无逻辑</li>
<li><code>&amp;&amp;</code> 命令1正确才执行2</li>
<li><code>||</code>命令1正确不执行2，1不正确才执行2</li>
<li>判断命令是否正确：<code>命令 &amp;&amp; echo yes || echo no</code></li>
</ol>
</li>
<li>管道符：<code>|</code>  <code>命令1|命令2</code>，1的正确输出作为2的输入<ol>
<li>ll | more</li>
</ol>
</li>
</ol>
<h2 id="5-通配符wildcard-character"><a href="#5-通配符wildcard-character" class="headerlink" title="5. 通配符wildcard character"></a>5. 通配符<em>wildcard</em> character</h2><ol>
<li>用于匹配文件名，跟正则表达式区分</li>
<li>？匹配一个字符</li>
<li>*任意</li>
<li>[]匹配中括号中的字符，如[abc]，匹配a或b或c</li>
<li>[a-z]匹配a-z的所有字母</li>
<li>[\^]逻辑非，[\^0-9] 匹配不是数字的字符</li>
</ol>
<h2 id="6-Bash-中的特殊符号："><a href="#6-Bash-中的特殊符号：" class="headerlink" title="6. Bash 中的特殊符号："></a>6. Bash 中的特殊符号：</h2><ol>
<li><code>&#39;&#39;</code> 原文字符</li>
<li><code>&quot;&quot;</code> 可读取特殊字符</li>
<li>“``” 反引号，引用系统命令，同$()，不推荐</li>
<li><code>$()</code> 引用系统命令，赋给变量，推荐使用<ol>
<li>eg. <code>echo $(ls)</code></li>
</ol>
</li>
<li><code>#</code>注释</li>
<li><code>$</code>调用变量的值</li>
<li><code>\</code>转义字符，取消特殊符号的作用，变为普通符号</li>
</ol>
<h2 id="7-Bash的变量"><a href="#7-Bash的变量" class="headerlink" title="7. Bash的变量"></a>7. Bash的变量</h2><p>用户自定义变量；环境变量；位置参数变量；预定义变量</p>
<h2 id="7-1-用户自定义变量"><a href="#7-1-用户自定义变量" class="headerlink" title="7.1 用户自定义变量"></a>7.1 用户自定义变量</h2><ol>
<li><p>默认类型为字符串型，数值型需指定</p>
</li>
<li><p>变量用等号连接，<strong>等号两侧不能有空格</strong></p>
</li>
<li><p>变量值有空格，需要用引号括起来</p>
</li>
<li><p>变量值中可以使用转义字符\</p>
</li>
<li><p><strong>变量叠加</strong>：需要引号或花括号括起来：如<code>“$变量名”</code>  或 <code>${变量名}</code>。 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aa=123</span><br><span class="line">aa=<span class="string">"<span class="variable">$aa</span>"</span>456</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$aa</span></span><br><span class="line">输出：123456</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>命令结果作为变量赋值，需要用反引号或<code>$()</code>括起来</p>
</li>
<li><p>环境变量，建议大写</p>
</li>
<li><p>set命令，查看系统中所有变量（所有类型）</p>
</li>
<li><p>unset， 删除变量</p>
</li>
</ol>
<h2 id="7-2-环境变量"><a href="#7-2-环境变量" class="headerlink" title="7.2 环境变量"></a>7.2 环境变量</h2><ol>
<li>在当前和子shell中生效，写入配置文件则对所有shell生效</li>
<li>定义：<code>export 变量名=变量值</code></li>
<li><code>bash</code> 生成子shell, <code>pstree</code>进程树 </li>
<li><code>set</code>查询全部变量；<code>env</code>查看环境变量; <code>unset</code>删除变量</li>
<li>常用环境变量：<code>PATH</code>。自动在PATH路径下搜索命令。例如，把执行程序添加到PATH后，则不需用路径执行，可直接写程序名。<ol>
<li>eg. <code>PATH=&#39;$PATH&#39;:/root</code>变量叠加，临时更改，重启消失。冒号分割。</li>
</ol>
</li>
<li>PS1,定义系统提示符的变量</li>
</ol>
<h2 id="7-3-位置参数变量"><a href="#7-3-位置参数变量" class="headerlink" title="7.3 位置参数变量"></a>7.3 位置参数变量</h2><ol>
<li><p><img src="G:\git\blog\source\_posts\pic\Bash_Para.JPG" alt="Bash_Para"></p>
</li>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sum=$((<span class="variable">$1</span>+<span class="variable">$2</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$sum</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>$*</code>相当于1个字符串整体；<code>$@</code>相当于一个字符串数组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 循环1次</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"$*"</span></span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="comment">#循环多次</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line">	<span class="keyword">do</span> </span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$j</span></span><br><span class="line">	<span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hello.sh 1 2 3 4</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1234</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="7-4-预定义变量"><a href="#7-4-预定义变量" class="headerlink" title="7.4 预定义变量"></a>7.4 预定义变量</h2><ol>
<li><p><code>$?</code>上一条命令返回状态；0正确，非零错误</p>
</li>
<li><p><code>$$</code>当前进程号</p>
</li>
<li><p><code>$!</code>后台运行的最后一个进程的进程号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"$$"</span></span><br><span class="line">find /root -name hello.sh &amp;</span><br><span class="line"><span class="comment"># &amp;符号为后台执行</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"$!"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>接受键盘输入</p>
<ol>
<li><code>read [选项][变量]</code></li>
<li>-p “aa”： 提示信息</li>
<li>-t 秒数： 等待秒数</li>
<li>-n 字符数：接受字符数到了就执行，不用回车</li>
<li>-s ：隐藏输入显示</li>
</ol>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> -t 30 -p <span class="string">"please inpute name: "</span> name</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Name is <span class="variable">$name</span>"</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"\n"</span> <span class="comment">#-e激活转义字符，“\n”换行</span></span><br><span class="line"><span class="built_in">read</span> -t 30 -n 1 -p <span class="string">"gender[M/F]: "</span> gender</span><br><span class="line"><span class="built_in">echo</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"sex is <span class="variable">$gender</span>"</span></span><br></pre></td></tr></table></figure>
<h2 id="7-5-数值运算和运算符"><a href="#7-5-数值运算和运算符" class="headerlink" title="7.5 数值运算和运算符"></a>7.5 数值运算和运算符</h2><ol>
<li><p>默认为字符串型，因此数值不可直接相加</p>
</li>
<li><p><code>declare [+/-][选项] 变量名</code>：</p>
<ol>
<li>-： 给变量设定类型属性</li>
<li>+：取消变量的类型属性</li>
<li>-i：设为整型</li>
<li>-x：设为环境变量</li>
<li>-p：查看类型</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aa=11</span><br><span class="line">bb=22</span><br><span class="line"><span class="built_in">declare</span> -i cc=<span class="variable">$aa</span>+<span class="variable">$bb</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>expr或let数值运算工具</p>
<ol>
<li><code>cc=$(expr $aa + $bb)</code> 加号左右两侧空格必要</li>
</ol>
</li>
<li><p><code>$((运算式))</code>或<code>$[运算式]</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc=$((<span class="variable">$aa</span>+<span class="variable">$bb</span>))</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="7-6-变量测试和内容替换"><a href="#7-6-变量测试和内容替换" class="headerlink" title="7.6 变量测试和内容替换"></a>7.6 变量测试和内容替换</h2><p><img src="G:\git\blog\source\_posts\pic\Bash_ParaTest.JPG" alt="Bash_ParaTest"></p>
<h1 id="8-环境变量"><a href="#8-环境变量" class="headerlink" title="8. 环境变量"></a>8. 环境变量</h1><p><a href="https://www.bilibili.com/video/av47009997/?p=212" target="_blank" rel="noopener">https://www.bilibili.com/video/av47009997/?p=212</a></p>
<h2 id="8-1-环境变量配置文件"><a href="#8-1-环境变量配置文件" class="headerlink" title="8.1 环境变量配置文件"></a>8.1 环境变量配置文件</h2><ol>
<li><p>source命令：<code>source 配置文件</code> 或<code>. 配置文件</code>，让文件直接生效，不需重新登陆。也可理解为“调用”</p>
</li>
<li><p>例：PATH: <code>PATH=&quot;$PATH&quot;:/root</code>加入root目录</p>
</li>
<li><p>配置文件：</p>
<ol>
<li><code>/etc/profile</code>: /etc/下的文件是对所有用户都生效</li>
<li><code>/etc/profile.d/*.sh</code>：一系列文件</li>
<li><code>/etc/bashrc</code>：命令提示符等</li>
<li><code>~/.bash_profile</code>：~/文件下是当前用户的家目录，只对当前用户生效</li>
<li><code>~/.bashrc</code></li>
</ol>
<p>顺序：<code>/etc/profile</code> -&gt; <code>~/.bash_profile</code>-&gt;<code>~/.bashrc</code> -&gt;<code>/etc/bashrc</code> -&gt;<code>（/etc/profile.d/*.sh）</code>-&gt;命令提示符</p>
</li>
<li><p>向后的文件优先级高，会覆盖前面的变量</p>
</li>
<li><p>本地终端欢迎信息：/etc/issue</p>
</li>
<li><p>远程终端欢迎信息：/etc/issue.net; 只能纯文本，转义符不可用</p>
</li>
<li><p>本地远程据可用，登陆后欢迎信息：/etc/motd</p>
</li>
</ol>
<h1 id="9-正则表达式"><a href="#9-正则表达式" class="headerlink" title="9. 正则表达式"></a>9. 正则表达式</h1><h2 id="9-1-正则表达式和通配符的区别"><a href="#9-1-正则表达式和通配符的区别" class="headerlink" title="9.1 正则表达式和通配符的区别"></a>9.1 正则表达式和通配符的区别</h2><ul>
<li>正则匹配字符串，包含匹配（含有就列出），grep,awk,sed</li>
<li>通配符匹配文件名，完全匹配（只列出完全一样的）,ls,find,cp</li>
</ul>
<h2 id="9-2-常用元字符"><a href="#9-2-常用元字符" class="headerlink" title="9.2 常用元字符"></a>9.2 常用元字符</h2><ul>
<li><code>*</code><strong>前一个字符</strong>匹配0次或任意多次，<strong>0次</strong>也包括。若包含至少一个a,写两个a: <code>aa*</code></li>
<li><code>.</code> 匹配除了换行符外的任意<strong>1个</strong>字符。<ul>
<li>例如：<code>s..d</code>匹配s d中两个字母，如said。</li>
<li><code>s.*d</code>匹配s d中有任意字符</li>
<li><code>.*</code>匹配所有内容</li>
</ul>
</li>
<li><code>^</code> 匹配行首，如 <code>^hello</code>匹配hello开头的行</li>
<li><code>$</code> 匹配行尾，如<code>hello$</code>匹配以hello结尾的行<ul>
<li><code>^$</code>空白行</li>
</ul>
</li>
<li><code>[]</code> 匹配中括号中指定的任意一个字符，如[abc],[0-9]<ul>
<li>grep -n “s[ao]id”，匹配said和soid</li>
</ul>
</li>
<li><code>[^]</code> 匹配除非中括号字符中的一个字符，即<strong>取非</strong>，如[\^0-9]匹配非数字<ul>
<li><code>grep &quot;^[^a-zA-Z]&quot;</code>匹配不以所有字母开头的行</li>
</ul>
</li>
<li><code>\</code> 转义字符，取消特殊符号的含义<ul>
<li><code>grep &quot;\.$&quot;</code>匹配“.”结尾</li>
</ul>
</li>
<li><code>\{n\}</code> 前面的字符连续出现n次（<code>\{</code>即是用转义字符转义了大括号），例如：<code>[0-9]\{4\}</code>匹配4为数字。<code>[1][3-8][0-9]\{9\}</code> 匹配手机号<ul>
<li><code>grep “a\{3\}”</code>匹配连续出现3个a</li>
</ul>
</li>
<li><code>\{n,\}</code>前面的字符出现不小于n次。例如：<code>[a-z]\{2,\}</code>两位以上字母</li>
<li><code>\{n,m\}</code>前面的字符出现n-m次。</li>
</ul>
<h2 id="If-Statement"><a href="#If-Statement" class="headerlink" title="If Statement"></a>If Statement</h2><ol>
<li><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	statement</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>注意</strong> 条件语句括号内两边必须留有空格，否则报错！</p>
</li>
<li><p>integer comparison</p>
<ol>
<li>-eq  is equal to    if [ “\$a” -eq “\$b” ]</li>
<li>-ne not equal</li>
<li>-gt greater than</li>
<li>-ge greater than or equal to</li>
<li>-lt less than</li>
<li>-le less than or equal to</li>
<li>&lt;,&lt;=,&gt;,&gt;=</li>
</ol>
</li>
<li><p>string comparison</p>
<ol>
<li>= is equal to</li>
<li>== is equal to</li>
<li>!=</li>
<li>&lt;</li>
<li>></li>
<li>-z  is null</li>
</ol>
</li>
<li><p>eg </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">count=10</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$count</span> -eq 10 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"it is true"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>或用两个小括号(parenthesis): <code>if (($a &gt;10))</code>, 无需留空格</p>
</li>
<li></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/07/02/Linux_shell/" data-id="cjxuei1c400027sukeac6ysc2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Linux_web" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/23/Linux_web/" class="article-date">
  <time datetime="2019-06-23T10:08:36.155Z" itemprop="datePublished">2019-06-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/23/Linux_web/">Linux Web</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.bilibili.com/video/av47009997/?p=245" target="_blank" rel="noopener">https://www.bilibili.com/video/av47009997/?p=245</a></p>
<h1 id="p249-OSI七层模型和TCP四层模型"><a href="#p249-OSI七层模型和TCP四层模型" class="headerlink" title="p249 OSI七层模型和TCP四层模型"></a>p249 OSI七层模型和TCP四层模型</h1><ol>
<li><p>OSI 七层</p>
</li>
<li><p>TCP 4层：应用层，传输层，网际互连层，网络接口层</p>
<ol>
<li>网络接口层：ARP协议（地址解析协议），获取MAC地址，即IP地址解析为MAC地址（即物理地址，48位16进制）。局域网内使用mac地址，公网使用ip地址。交换机：记住局域网mac，转为ip</li>
<li>网际互连层：即网络层，三个主页协议：IP网际协议,IGMP互联网组管理协议,ICMP互联网控制报文协议</li>
<li>传输层：TCP, UDP协议; TCP/IP 三次握手，可靠，断点连接，</li>
<li>端口：端口号：相当于收件人。win查看端口：netstat -an。常见端口号是固定的,1024以下：如邮件SMTP:25。端口与服务对应。 </li>
</ol>
</li>
<li><p>TCP/IP数据封装过程：假设是FTP文件：FTP头是FTP文件特征；TCP头是收发端口号等；IP头是收发IP; 以太帧头：收发mac，传递数据。</p>
<p><img src="/pic/TCPIP.jpg&quot;dlog&quot;" alt="Pic_dlog2"></p>
</li>
<li><p>IP 地址分类：A,B,C</p>
<p>127.0.0.1 本机</p>
<p>A：网段：ip第一位数，同一网段可通过交换机通信，</p>
<pre><code>   主机数：ip后三位
</code></pre><p>B：网段：ip前两位，主机数为后两位</p>
<p>C：网段：ip前3位，主机后1位</p>
<p>每个网段有一部分私有ip（内网ip），不需要申请，不同网段内可重叠，如C类：192.168.0.0-192.168.255.255</p>
</li>
<li><p>子网掩码：用来划分网段。子网掩码1，代表网络，0代表主机；如255.0.0.0，即第一位为网络，后面为主机，即A类</p>
</li>
<li><p>linux网络配置文件</p>
<ol>
<li>/etc/sysconfig/network-scripts/ifcfg-eth0</li>
<li>/etc/sysconfig/network 主机名</li>
<li>/etc/resolv.conf     DNS信息</li>
</ol>
</li>
<li><p>hostname主机名，默认：localhost.localdomain</p>
</li>
<li><p>常用命令：</p>
<ol>
<li>ifdown,ifup. 关闭/开启网卡</li>
<li>netstat 查询网络状态</li>
<li>ping </li>
<li>telnet 连接远程主机（古老版ssh，明文无加密）：远程管理和端口探测命令</li>
<li>traceroute 路由追踪</li>
<li>wget 下载命令</li>
</ol>
</li>
</ol>
<h1 id="P256-SSH"><a href="#P256-SSH" class="headerlink" title="P256 SSH"></a>P256 SSH</h1><ol>
<li>端口号：22</li>
<li>加密：<ol>
<li>对称加密：加密解密密钥相同；</li>
<li>SSH:非对称加密：创建公钥(锁)和私钥(钥匙)；加密：公钥。解密：密码+私钥</li>
</ol>
</li>
<li>SSH配置文件：/etc/ssh/ssh/ssh_config 客户端；/sshd_config 服务器</li>
<li>命令：<ol>
<li>ssh 用户名@ip</li>
<li>scp远程复制</li>
<li>sftp root@ip 文件传输 <code>get</code>下载,<code>put</code>上传</li>
<li></li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/23/Linux_web/" data-id="cjxuei1c100017sukcxodpoyd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-A_Cooperative_Multi-Agent_DRL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/20/A_Cooperative_Multi-Agent_DRL/" class="article-date">
  <time datetime="2019-06-20T07:32:30.936Z" itemprop="datePublished">2019-06-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/20/A_Cooperative_Multi-Agent_DRL/">A Cooperative Multi-Agent Deep Reinforcement Learning Framework for Real-Time Residential Load Scheduling</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="A-Cooperative-Multi-Agent-Deep-Reinforcement-Learning-Framework-for-Real-Time-Residential-Load-Scheduling"><a href="#A-Cooperative-Multi-Agent-Deep-Reinforcement-Learning-Framework-for-Real-Time-Residential-Load-Scheduling" class="headerlink" title="A Cooperative Multi-Agent Deep Reinforcement Learning Framework for Real-Time Residential Load Scheduling"></a>A Cooperative Multi-Agent Deep Reinforcement Learning Framework for Real-Time Residential Load Scheduling</h1><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><ol>
<li>develop a multi-household energy management framework for residential units connected to the same transformer and containing DERs</li>
<li>schedule controllable household appliances and ESS such that the cost of procuring electricity from the utility over a horizon is minimized while physical grid constraints are satisfied at each scheduling step</li>
<li>Problems of others’ methods*:  <ul>
<li>global optimiztion but complex</li>
<li>decentralized without global concern</li>
</ul>
</li>
<li>Novelty:<ul>
<li>multiagent reinforcement learning (MARL) </li>
<li>trains multiple independent learners using historical data</li>
<li>low complexity cooperation agent <h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2></li>
</ul>
</li>
<li>Markov Decision Process<script type="math/tex; mode=display">M=(S,A,T,\gamma,R)</script><script type="math/tex; mode=display">\pi(a|s): Policy</script><script type="math/tex; mode=display">maximize(\sum_{t=0}^{\infin}\Epsilon[\gamma^tR(s_t,a_t,s_{t+1})])</script></li>
<li>Deep Reinforcement Learning<script type="math/tex; mode=display">
\nabla_\theta J(\theta)=\Epsilon[\nabla_\theta(min(r_t(\theta)A_t,clip(r_t(\theta),1-\epsilon,1+\epsilon)A_t))]</script><script type="math/tex; mode=display">
r_t(\theta)=\frac{\pi_{\theta}}{\pi_{\theta_{old}}}\\
A_t=\sum_{t'=t}^{\infin}\gamma^{t'-t}R(s_t,a_t)-V(s_t)</script><h2 id="Expansion-of-DRL-in-the-Paper"><a href="#Expansion-of-DRL-in-the-Paper" class="headerlink" title="Expansion of DRL in the Paper"></a>Expansion of DRL in the Paper</h2><h3 id="Value-Function："><a href="#Value-Function：" class="headerlink" title="Value Function："></a>Value Function：</h3></li>
<li><ul>
<li>s状态，a动作下，遵循$\pi$策略获得奖励G的期望:<script type="math/tex; mode=display">Q_\pi(s,a)=\Epsilon(G_t|S_t=s,A_t=a)</script></li>
</ul>
</li>
</ol>
<ul>
<li>奖励函数<script type="math/tex; mode=display">G_t=R_{t+1}+\gamma R_{t+2}+\gamma^2 R_{t+3}+...</script></li>
<li>$\pi$ 是通过s状态获得a动作的函数<script type="math/tex; mode=display">a=\pi(s)</script></li>
</ul>
<ol>
<li>迭代过程：<ul>
<li>prediction，给定策略，求Q  </li>
<li>control 根据Q优化策略<h3 id="Model-Free"><a href="#Model-Free" class="headerlink" title="Model Free"></a>Model Free</h3></li>
</ul>
</li>
<li>无状态S和转移概率。</li>
<li>Monte Carlo</li>
</ol>
<h2 id="Multi-Agent-RL"><a href="#Multi-Agent-RL" class="headerlink" title="Multi-Agent RL"></a>Multi-Agent RL</h2><ol>
<li>($S_1,…,S_n,A_1,…,A_n,T,\gamma,R$)</li>
<li>constrains: $f(a_1,a_2,…)\leq C$</li>
<li>homogeneous sub environment and equally weighed rewards</li>
<li>innovation:<ul>
<li>train IL</li>
<li>use trained IL to cooperate<h2 id="Problem-Setup"><a href="#Problem-Setup" class="headerlink" title="Problem Setup"></a>Problem Setup</h2></li>
</ul>
</li>
<li>Single Household Energy Model<ul>
<li>T=96(15 min interval)</li>
<li>ESS Storage, E(t):battery energy in time t<ul>
<li>$E_{b,n}(t+1)=\eta_{b,n}E_{b,n}(t)+\lambda_{b,n}(t)P_{b,n}\Delta t$</li>
<li>下一时刻电池能量=效率*上一时刻能量+开关*功率*dt</li>
</ul>
</li>
<li>Loads：<ul>
<li>Modifiable power loads 可调功率负载<ul>
<li>HVAC(Heating, Ventilation and Air Conditioning空调),EV charging</li>
<li>For household n, action: $a_n(t)=(a_{n,1}(t),a_{n,2}(t),…,a_{n,M}(t)) \ a_{n,m}=1/0, turn on/off$</li>
</ul>
</li>
<li>Time shiftable loads<ul>
<li>fixed power and length,cannot be interrupted(dish washer, laundry units)</li>
</ul>
</li>
<li>Non-shiftable loads</li>
</ul>
</li>
<li>PV generation and Dynamic Price<ul>
<li>assume only predict by observing history</li>
</ul>
</li>
</ul>
</li>
<li>Transformer Capacity Constraint<ul>
<li>|SUM(E)|&lt;Ck</li>
<li>P,Q limit：real and reactive power<h2 id="Markov-Decision-Process-Setup"><a href="#Markov-Decision-Process-Setup" class="headerlink" title="Markov Decision Process Setup"></a>Markov Decision Process Setup</h2><h3 id="State-Space"><a href="#State-Space" class="headerlink" title="State Space"></a>State Space</h3></li>
</ul>
</li>
<li>Local fully observable states:<ul>
<li>at time t, remaining load vector</li>
</ul>
</li>
<li>Local partial observable states<ul>
<li>PV before time t. pv(0),pv(1)…pv(t-1)</li>
</ul>
</li>
<li>Global partial obervable states:<br>price before time t:c(0)…c(t-1)<br>【<strong>不知t时刻state</strong>】</li>
<li>Initial State<ul>
<li>The remaining load ln,m(1) = Ln,m,∀n,m. </li>
<li><strong>$L_n,m$为负载所需运行时间数；$l_n,m$为负载剩余运行时间数（时间数为15min一个数）</strong></li>
<li>random initial storage Eb,n(1)</li>
<li>generated household PV generation and unit energ price<h3 id="4-1-Action-Space"><a href="#4-1-Action-Space" class="headerlink" title="4.1 Action Space"></a>4.1 Action Space</h3></li>
</ul>
</li>
<li>The binary vector an(t) to turn on/off each load</li>
<li>battery operation $\lambda$ <h3 id="4-2-Transition-Mode"><a href="#4-2-Transition-Mode" class="headerlink" title="4.2 Transition Mode"></a>4.2 Transition Mode</h3></li>
</ol>
<ul>
<li><strong>$E_{grid}$和动作a，$\lambda$的关系</strong>：$\star<script type="math/tex">\star</script>\star$<script type="math/tex; mode=display">\sum a(t)P_n+\lambda(t)P_b=pv(t)+E_{grid}(t)/{\Delta t},\forall n,t</script></li>
<li>ln,m(t + 1) = ln,m(t) − an,m(t),∀m,n<br>下一时刻剩余负载=本时刻剩余负载-本时刻动作</li>
<li>eg. 本时刻n家庭m设备剩余15时间数，动作是on（即1），下一时刻剩余14时间数；动作是off（即0）,则下一时刻仍然剩余15时间数。</li>
<li>适用modifiable loads，其他化为此类<h3 id="4-3-System-Constrains"><a href="#4-3-System-Constrains" class="headerlink" title="4.3 System Constrains"></a>4.3 System Constrains</h3></li>
</ul>
<ol>
<li>Local,turning on time = load time requirment.<script type="math/tex; mode=display">\sum_{t=1}^Ta_{n,m}(t)=L_{n,m},\forall m,n</script></li>
<li><p>Global, |E|&lt;C</p>
<h3 id="4-4-Objective"><a href="#4-4-Objective" class="headerlink" title="4.4 Objective"></a>4.4 Objective</h3><p>minimize energy cost:</p>
<script type="math/tex; mode=display">J=\sum_{t=1}^T\sum_{n=1}^NE_{grid,n}(t)c(t)</script><p>subject to |E|&lt;C<br>其中E由$\star<script type="math/tex">\star</script>\star$中的关系替代，则目标是动作a和$\lambda$</p>
<h2 id="5-APPROACH"><a href="#5-APPROACH" class="headerlink" title="5 APPROACH"></a>5 APPROACH</h2><h3 id="5-1-Baseline-Approaches"><a href="#5-1-Baseline-Approaches" class="headerlink" title="5.1 Baseline Approaches"></a>5.1 Baseline Approaches</h3><blockquote>
<ol>
<li>offline optimization</li>
<li>online opt</li>
<li>centralized reinforcement learning agent</li>
</ol>
</blockquote>
</li>
<li><p>offline. day-ahead planning</p>
<ul>
<li>Integer Linear Programming (ILP)</li>
<li><strong>python PuLP 包</strong> <a href="https://pythonhosted.org/PuLP/" target="_blank" rel="noopener">https://pythonhosted.org/PuLP/</a></li>
<li>“w.r.t = with respect to 关于”</li>
<li>解得动作a和$\lambda$</li>
</ul>
<ol>
<li>Online Optimization</li>
</ol>
<ul>
<li>also use ILP</li>
<li>also generate a sequence</li>
<li>only use next step action</li>
</ul>
<ol>
<li>Centralized Reinforcement Learning<h3 id="5-2-Cooperative-RL"><a href="#5-2-Cooperative-RL" class="headerlink" title="5.2 Cooperative RL"></a>5.2 Cooperative RL</h3></li>
</ol>
</li>
<li>discretize capacity C into {0,1,…C’}</li>
<li>for each c $\in${0,1…C’} and household n, train Independent Learner. $A_{n,c}$,using PPO.</li>
<li>coopoeration:select action from each household such that Sum(c)$\leq$C’and reward is max.</li>
<li>Solution of above problem: dynamic programming formulation.<script type="math/tex; mode=display">\Phi(c,n+1)=\max_{c'\in \{0,1...C'\}}\{\Phi(c-ac_{n+1,c'},n)+r_{n+1,c'}\}</script><h4 id="5-2-1-Indipendent-Learners"><a href="#5-2-1-Indipendent-Learners" class="headerlink" title="5.2.1 Indipendent Learners"></a>5.2.1 Indipendent Learners</h4></li>
<li>PPO</li>
<li>model relationship between different actions,use <strong>Multivariate Gaussian Controller</strong>_?_(mean,covariance matrix)</li>
<li>neg reward when &gt;C</li>
<li>too noisy -&gt; supervised train first with ILP result.<h4 id="5-2-2-Approximation-Algorithm——to-reduce-time-complexity"><a href="#5-2-2-Approximation-Algorithm——to-reduce-time-complexity" class="headerlink" title="5.2.2 Approximation Algorithm——to reduce time complexity"></a>5.2.2 Approximation Algorithm——to reduce time complexity</h4></li>
<li>algorithm come from paper ‘Thomas Erlebach, Hans Kellerer, and Ulrich Pferschy. 2002. Approximating<br>multiobjective knapsack problems. Management Science 48, 12 (2002), 1603–1612.’</li>
<li>Knapsack problem 背包问题，与本文问题类似<br>‘<a href="https://wenku.baidu.com/view/9f584b8b70fe910ef12d2af90242a8956becaa6b.html?rec_flag=default&amp;sxts=1560244579999" target="_blank" rel="noopener">https://wenku.baidu.com/view/9f584b8b70fe910ef12d2af90242a8956becaa6b.html?rec_flag=default&amp;sxts=1560244579999</a>‘</li>
</ol>
<h2 id="6-Experimental-Setup"><a href="#6-Experimental-Setup" class="headerlink" title="6 Experimental Setup"></a>6 Experimental Setup</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/20/A_Cooperative_Multi-Agent_DRL/" data-id="cjxuei1bd00007suk1q56c2rn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Linux_note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/17/Linux_note/" class="article-date">
  <time datetime="2019-06-17T02:14:05.841Z" itemprop="datePublished">2019-06-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/17/Linux_note/">Linux Note</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.bilibili.com/video/av47009997/?p=25" target="_blank" rel="noopener">https://www.bilibili.com/video/av47009997/?p=25</a></p>
<h1 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h1><ol>
<li>shell 提示符[用户@主机名 目录]提示符  root：#   用户：$</li>
<li>linux 命令输入规律：<br>命令 [选项]（[参数]）[选项的值]（[参数的值]）</li>
<li>常见选项：-h —help -字母，—单词</li>
<li>hwclock 硬件时间</li>
<li>关机： shutdown,init,reboot</li>
<li>init 命令：切换系统运行级别，7个启动级别<br>init 0: 0级别，即关机<br>init 6：重启</li>
</ol>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><ol>
<li>/ 根分区</li>
<li>/etc 配置文件，启动关闭脚本：/etc/passwd,etc/init.d/network</li>
<li>/boot 启动加载文件</li>
<li>/home 用户</li>
<li>/var 可增长目录</li>
<li>/root 管理员 </li>
<li>/usr unix software resource</li>
<li>/bin 命令，二进制可执行文件</li>
<li>/sbin 系统命令 reboot等</li>
<li>/mnt 挂载点</li>
<li>/dev 设备文件 ：<br>/dev/sda 硬盘<br>一切皆文件</li>
</ol>
<h2 id="相对路径，绝对路径"><a href="#相对路径，绝对路径" class="headerlink" title="相对路径，绝对路径"></a>相对路径，绝对路径</h2><ol>
<li>. 表示当前目录； ..表示上级目录<br>cd ./;  cd ../</li>
</ol>
<h2 id="文件和文件夹"><a href="#文件和文件夹" class="headerlink" title="文件和文件夹"></a>文件和文件夹</h2><ol>
<li>创建文件：touch a.txt</li>
<li>创建目录：mkdir /tmp/test</li>
<li>创建多个 -p 连同父目录一起创建<br>eg. mkdir -p /a/b/c</li>
<li>cd !$ : 上一命令的最后一个参数</li>
<li>cd ../../</li>
<li>查看文件：cat；vim；more；less</li>
<li>head -n 显示前3行，默认10行<br>tail -n 显示后n行； -f 动态显示数据， 查看日志</li>
<li>文件的复制：cp 源文件 目标文件</li>
<li>目录的复制：cp -r 。。。 递归执行</li>
<li>蓝色显示：目录；浅蓝色：软链接； 普通色：文件</li>
<li>删除 rm -rf 全部删除：-r递归，-f强制删除</li>
<li>重命名：mv 文件名（目录） 新文件名（目录）</li>
</ol>
<h1 id="p9-远程连接工具"><a href="#p9-远程连接工具" class="headerlink" title="p9-远程连接工具"></a>p9-远程连接工具</h1><ol>
<li>xmanager</li>
<li>查看linux ip地址： ifconfig</li>
<li>安装ssh： <ol>
<li>更新软件源：sudo apt-get update ，sudo apt-get upgrade</li>
<li>安装ssh: sudo apt-get install -y openssh-server</li>
</ol>
</li>
<li>XShell连接，填写用户名zhangpm，密码zhangpm123</li>
<li>Xstart, ubuntu安装xterm: sudo apt-get install -y xterm<br>Xstart 命令选xterm</li>
<li>uname -m 查看系统版本</li>
</ol>
<h1 id="p-10-vim使用"><a href="#p-10-vim使用" class="headerlink" title="p-10 vim使用"></a>p-10 vim使用</h1><ol>
<li>rpm 安装软件</li>
<li><p>模式：</p>
<ol>
<li><p>命令行模式：<br>:w 保存；<br>:q 退出<br>:q! 强退<br>:wq 保存退<br>:wq! 强制保存退出<br>: r修改单个文字<br>:ZZ 保存<br>:%s/this/that 每一行第一个this替换成that<br>:%s/this/that/g 文本中所有this 替换成that</p>
</li>
<li><p>视图模式：ctrl V<br> *多行注释：</p>
<ol>
<li>ctrl v</li>
<li>移动光标选中多行</li>
<li>按大写I</li>
<li>插入注释符号</li>
<li>Esc</li>
</ol>
</li>
</ol>
</li>
<li>搜索： “/”符号  n下找，N下找<br>:noh 不高亮显示</li>
<li>:!+命令行命令</li>
<li>:set nu 显示行号</li>
<li>行首 gg</li>
<li>行尾 G</li>
<li>自定义vim ： vim /root/.vimrc， 写入自定义，例如 set nu</li>
</ol>
<h1 id="p-11"><a href="#p-11" class="headerlink" title="p-11"></a>p-11</h1><ol>
<li>Xshell rz 命令上传文件到linux<ol>
<li>安装rz： sudo apt-get install lrzsz</li>
</ol>
</li>
<li>文字乱码：win：gb2312； linux: utf-8<br>转码：iconv -f gb2312 c.txt -o sss.txt</li>
<li>linux-&gt;windows, 串行，处理回车不同（换行符问题）<br>解决：安装unix2dos.<br>unix2dos b.txt</li>
</ol>
<h1 id="p12-文件-用户，组"><a href="#p12-文件-用户，组" class="headerlink" title="p12-文件,用户，组"></a>p12-文件,用户，组</h1><ol>
<li>root:x:0:0:root:/root:/bin/bash<pre><code>     UID            Shell
</code></pre></li>
<li>密码： /etc/shadow</li>
<li>添加用户：useradd -u 5003 zhangpm2</li>
<li>修改当前用户密码：passwd</li>
<li>非交互添加密码：echo 123456 | passwd —stdin root</li>
<li>linux 用户密码加密：sha512</li>
<li>usermod 更改用户模式</li>
<li>userdel 删除用户 -username</li>
<li>添加组：groupadd XX</li>
<li><p>su 切换用户：</p>
<p>​    切换到root：su</p>
<p>​    切换到其他用户：su - zhangpm  （注意中间的短横，代表连带shell一同切换）</p>
</li>
<li>single user mode 单用户模式，破解更改root密码<br>方法2：root passwd 中x密码占位符删掉，登录则不需密码</li>
<li>权限：<ol>
<li>文件：r w x 读 写 执行</li>
<li>目录：r读，w增删移动文件，x进入</li>
<li>修改权限：chmod</li>
<li>chomd u+r 拥有者user加r权限<br> g-w 组减去w权限<br> o=x others覆盖赋值x权限<br> a+x all加x权限</li>
<li>chown 修改所属组 -R递归</li>
<li>touch a.txt 创建a文件</li>
<li>只读文件可以强制改写</li>
<li>echo aaa&gt;&gt;a.txt aaa追加到a.txt</li>
<li>chattr +a 无法删除的文件 +i 无法追加</li>
<li>lsattr a.txt 查看attr权限</li>
<li>charttr -a 去除a权限</li>
</ol>
</li>
</ol>
<h1 id="p17软件包安装"><a href="#p17软件包安装" class="headerlink" title="p17软件包安装"></a>p17软件包安装</h1><ol>
<li>挂载：mount</li>
<li>ls(ll) /a/b |wc -l，查看行数</li>
<li>源码安装：需要：开发工具，开发库<ol>
<li>解压：<strong>tar -jxvf</strong> 文件名； gz结尾文件：tar -zxvf</li>
<li>cd 文件名</li>
<li>检查安装环境：<strong>./configure</strong>：可能报错，需要安装部分包</li>
<li>编译：<strong>make</strong></li>
<li>安装：<strong>make install</strong></li>
<li>删除：在安装路径下：<strong>make uninstall</strong>，<strong>make clean</strong></li>
</ol>
</li>
</ol>
<h1 id="P19"><a href="#P19" class="headerlink" title="P19"></a>P19</h1><ol>
<li>tar 命令。打包，压缩<br>tar -cf（-cvf） a.tar foo bar 打包create tar<br>tar -tvf archive.tar  ~list all files in tar<br>tar -xf（-xvf） archive.tar   extract files from tar</li>
<li>c:create;v:verbose(详细);f:file;x:extract</li>
<li>tar —help | grep v 查看tar命令help里的“-v”</li>
<li>linux 拓展名不能代表类型</li>
<li>查看文件类型：file 文件名（路径）</li>
<li>解包：tar -xvf archive.tar -C PATH</li>
<li>du -h /boot/ 查看文件大小：disk usage</li>
<li>tar 打包+压缩：格式：.tar.gz 或 .tgz<br>语法：tar -czvf newfile.tar.gz SOURCE<br>-z, —gzip<br>解压缩：tar -zxvf newfile.tar.gz -C PATH<br>-C: change directory to</li>
<li>bz2 : 另一种压缩格式：z改为j</li>
<li>zip 压缩<br>zip a.zip FILE 压缩文件<br>zip -r a.zip DIRECTION 压缩目录<br>解压：unzip -d PATH</li>
</ol>
<h1 id="P21-进程管理"><a href="#P21-进程管理" class="headerlink" title="P21 进程管理"></a>P21 进程管理</h1><ol>
<li>程序：静态； 进程：动态</li>
<li>进程和线程：一个程序至少一个进程，一个进程至少一个线程<br>进程之间内存独立；<br>线程之间内存共享，高并发好，安全性差</li>
<li>进程树：pstree：（ps：processes）</li>
<li>man ps 查看ps命令手册</li>
<li>ps -aux （a：all，u：user；x：执行命令）</li>
<li>ps STAT 状态：5种：<br>R:RUNNING<br>S: sleeping<br>T: 暂停（ctrl z）<br>(ctrl c 停止)<br>Z：zombie僵尸状态<br>D：不可中断</li>
<li>&lt; 高优先级<br>N 低优先级<br>s 包含子进程<br>l 多线程<ul>
<li>前台程序</li>
</ul>
</li>
<li>top 动态查看进程 </li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>PID</th>
<th>USER</th>
<th>PR</th>
<th>NI</th>
<th>VIRT</th>
<th>RES</th>
<th>SHR</th>
<th>S</th>
<th>%CPU</th>
<th>%MEM</th>
</tr>
</thead>
<tbody>
<tr>
<td>进程号</td>
<td>用户</td>
<td></td>
<td>nice优先级</td>
<td></td>
<td>实际使用内存大小</td>
<td>进程状态（6条）</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>q退出, M 按内存排序，P 按CPU排序,&lt;&gt;翻页</li>
<li><strong>kill 信号 PID</strong> 停止（控制）进程； 信号：</li>
</ol>
<ul>
<li>1，HUP 重启 </li>
<li>2，INT = ctrl c 通知终止</li>
<li>9，kill 强行中断</li>
<li>19，stop = ctrl z</li>
<li>eg. kill -9 [PID]</li>
</ul>
<ol>
<li>killall 程序名<br>或：pkill 程序名</li>
<li>nice 优先级<ol>
<li>-20 ~ 19，高~低</li>
<li>nice -n -5 vim a.txt 用优先级-5打开a.txt，优先级高，运行快</li>
<li>renice -n 5 pid</li>
</ol>
</li>
<li>jobs列出所有后台进程</li>
<li>后台变前台：fg + 后台进程序列号</li>
<li>查看系统内存<ol>
<li>free -m</li>
<li>buffer缓存读入/cache缓存待写入</li>
<li>存储结构：disk-&gt;buffer/cache-&gt;memory</li>
</ol>
</li>
<li>远程终端后台运行的方法：<ol>
<li>screen 安装，使用</li>
<li>敲screen</li>
<li>输入ctrl+a+d</li>
<li>显示detached</li>
<li>重新连接：</li>
<li>screen ls 查看id</li>
<li>screen -r id</li>
<li>screen -wipe 清楚死去的窗口</li>
<li>方法2：nohub 命令 &amp;</li>
</ol>
</li>
</ol>
<h1 id="P24-输入输出重定向"><a href="#P24-输入输出重定向" class="headerlink" title="P24 输入输出重定向"></a>P24 输入输出重定向</h1><ol>
<li>文件描述符：<ul>
<li>0：STDIN, 标准输入</li>
<li>1: STDOUT，标准输出</li>
<li>2: STDERR，标准错误输出</li>
</ul>
</li>
<li>输出重定向：<ul>
<li>> 默认为1</li>
<li>eg: xxx &gt;/dev/null  2&gt;&amp;1  </li>
<li>解释：/dev/null:黑洞文件夹；&gt;为输出重定向；</li>
<li>1&gt; 标准输出重定向</li>
<li>2&gt; 标准错误输出重定向</li>
<li>&amp; 等同于</li>
<li>2&gt;&amp;1：错误输出重定向等同于1</li>
<li>eg：ls /home 1&gt;a.txt</li>
<li>把ls的结果重定向给a.txt</li>
<li>eg: ls /home/ /homee 1&gt;log.txt 2&gt;err.txt</li>
<li>ls /home/ /homee &gt; a.txt 2&gt;&amp;1</li>
<li>ls语句标准输出1重定向到a.txt，错误2输出重定向到“等同于1”，即也是a.txt</li>
<li>> 和 &gt;&gt; 的区别：&gt;&gt;表示追加写入；> 覆盖写入</li>
</ul>
</li>
<li>输入重定向：\&lt;<ul>
<li>eg: wc 命令，word count</li>
<li>用法1：cat /etc/passwd | wc -l 行数统计</li>
<li>用法2：<code>wc &lt; /etc/passwd</code> 显示行；单词；大小</li>
<li><code>&lt;&lt;EOF</code> </li>
<li><code>cat &gt; a.txt &lt;&lt;EOF</code> 输入以EOF结尾的文字，输入到a.txt, 并cat输出</li>
</ul>
</li>
<li>管道 <code>|</code> 输出作为输入<ul>
<li>eg: cat /etc/passwd | more</li>
</ul>
</li>
<li><code>tee</code>标准输出的内容写到文件中<ul>
<li>cat /etc/passwd | tee a.txt</li>
<li>跟<code>&gt;</code>区别：&gt;不显示</li>
</ul>
</li>
</ol>
<h1 id="P25-文件查找命令"><a href="#P25-文件查找命令" class="headerlink" title="P25 文件查找命令"></a>P25 文件查找命令</h1><ol>
<li><p>find, which, whereis, locate, grep</p>
</li>
<li><p>grep: 过滤</p>
<ul>
<li><code>grep --color root /etc/passwd</code> 查找文件中带root的内容</li>
<li><code>ps -axu | grep vim</code> 前面的内容管道给后面grep输入，查找vim</li>
</ul>
</li>
<li><p>find [目录] [条件] [动作]</p>
<ul>
<li>[目录]，默认为当前目录</li>
<li>[条件]： <ul>
<li>-user -group -nouser -nogroup; <code>-user zhangm</code></li>
<li>-type (f 文件，d 目录，l连接，p管道…)</li>
<li>eg. <code>find /home/ -type d</code> 只查找目录</li>
<li>-name 按名字查，用 <code>*</code>号通配符匹配。<code>find /home/ -name *pass*</code></li>
<li>-size +NM 大于NM，-NM 小于NM <code>find /boot/ -size +2M</code></li>
<li>-mtime （modification time）修改内容时间； -atime -ctime； eg <code>find -mtime 1</code> 1天前（即前天）+1是两天前的所有。-1前天之内（即前天到当前）；ctime（change time）任意改变（包括属性）时间。atime（access time）访问时间</li>
<li>-perm 权限</li>
<li>-maxdepth 目录深度</li>
<li><strong>多条件：-a -o  ! 或 -and -or -not</strong> <code>find -type f -and -perm -002</code></li>
</ul>
</li>
<li>[动作]：-ls -ok -exec -print -printf<ul>
<li><code>find /root/test -type f -exec rm {} \;</code></li>
<li>找到type为f的文件，执行rm即删除操作，{}表示查找出来的内容，\;为动作固定结尾</li>
</ul>
</li>
</ul>
<h1 id="硬盘分区"><a href="#硬盘分区" class="headerlink" title="硬盘分区"></a>硬盘分区</h1><h2 id="1-硬盘分区"><a href="#1-硬盘分区" class="headerlink" title="1. 硬盘分区"></a>1. 硬盘分区</h2><ol>
<li>主分区：相当于C盘</li>
<li>扩展分区：相当于其他所有控件</li>
<li>逻辑分区：在扩展分区下分出DCE区</li>
</ol>
<h2 id="2-挂载"><a href="#2-挂载" class="headerlink" title="2. 挂载"></a>2. 挂载</h2><ol>
<li><p>即将文件目录挂载到硬盘上</p>
</li>
<li><p>eg.<code>mkdir /sda5</code> ，<code>mount /dev/sda5 /sda5/</code>把sda5目录挂载到/dev/sda5分区上</p>
</li>
<li>df -h 查看分区和挂载</li>
</ol>
<h2 id="3-卷标"><a href="#3-卷标" class="headerlink" title="3. 卷标"></a>3. 卷标</h2><ol>
<li>e2label /dev/sda1 查看卷标</li>
<li>e2label /dev/sda1 home-1 创建卷标，即起名字</li>
<li>开机自动挂载：修改配置文件。vim /etc/fstab</li>
<li>验证挂载：umount 卸载；mount -a 读fstab挂载</li>
</ol>
<h2 id="4-无法卸载"><a href="#4-无法卸载" class="headerlink" title="4. 无法卸载"></a>4. 无法卸载</h2><ol>
<li>有文件占用，命令：lsof(list open files)，查看哪些文件被那些命令打开。语法 lsof 文件系统挂载点</li>
<li>或fuser：<code>fuser -m -u -v /sda5</code></li>
<li>kill -9 ID，杀进程</li>
</ol>
<h2 id="5-GPT分区表：Guid-Partition-Table"><a href="#5-GPT分区表：Guid-Partition-Table" class="headerlink" title="5. GPT分区表：Guid Partition Table"></a>5. GPT分区表：Guid Partition Table</h2><ol>
<li>parted 磁盘分区工具</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/17/Linux_note/" data-id="cjwzqy5h70000r8ukx4v93ugt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-RDL_李宏毅" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/16/RDL_李宏毅/" class="article-date">
  <time datetime="2019-06-16T01:37:19.270Z" itemprop="datePublished">2019-06-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/16/RDL_李宏毅/">RDL_李宏毅</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Deep-Reinforcement-Learning"><a href="#Deep-Reinforcement-Learning" class="headerlink" title="Deep Reinforcement Learning"></a>Deep Reinforcement Learning</h1><ul>
<li><a href="https://www.bilibili.com/video/av48285039/?p=81" target="_blank" rel="noopener">https://www.bilibili.com/video/av48285039/?p=81</a></li>
</ul>
<h2 id="Outline"><a href="#Outline" class="headerlink" title="Outline:"></a>Outline:</h2><ul>
<li>Policy_based<ul>
<li>Actor</li>
</ul>
</li>
<li>Value_based<ul>
<li>Critic</li>
</ul>
</li>
</ul>
<h2 id="1-Policy-based-Approach——learn-an-actor"><a href="#1-Policy-based-Approach——learn-an-actor" class="headerlink" title="1. Policy_based Approach——learn an actor"></a>1. Policy_based Approach——learn an actor</h2><ol>
<li>Action= $ \pi(Observation) $</li>
<li>3 steps<ul>
<li>1) Neural Network as Actor</li>
<li>2) goodness of function</li>
<li>3) pick the best function</li>
</ul>
</li>
<li>example as a video game<ul>
<li>Input: the observation of machine(as a vector or matrix)</li>
<li>Output: actions’ score(probability) vector</li>
<li><img src="/pic/DRL_structure.JPG" alt="Pic" title="DRL_structure"></li>
</ul>
</li>
<li>Goodness of Actor<ul>
<li>actor $\pi_\theta(s)$ with network parameter $\theta$</li>
<li>total reward:$R_\theta=\sum_t^Tr_t$</li>
<li>$R_\theta$ has randomness, so we need to maximize the <strong>expected value $\overline{R}_\theta$</strong></li>
</ul>
</li>
<li>How to calculate the <strong>expectation</strong>?<ul>
<li>An episode is a trajectory $\tau$</li>
<li>$\tau=\{s_1,a_1,r_1,s_2,a_2,r_2,…s_T,a_T,r_T \}$</li>
<li>$R(\tau)=\sum_{n=1}^Nr_n$</li>
<li>if you use an actor,each $\tau$ has a probability to be sampled. the probability depends on the actor parameter $\theta$</li>
<li>$\overline{R}_\theta=\sum_{\tau}R(\tau)P(\tau|\theta)$:sum over all possible trajectory.</li>
<li>Use $\pi_\theta$ to play the game N times, obtain{$\tau^1,\tau^2,…,\tau^N$},<strong>sample</strong> $\tau$ from P($\tau|\theta$) N times  </li>
<li><strong>_IMPORTANT EQUATION NO. 1:_</strong></li>
<li><script type="math/tex; mode=display">\overline{R}_\theta=\sum_{\tau}R(\tau)P(\tau|\theta)\approx \frac{1}{N}\sum_{n=1}^{N}R(\tau^n)</script></li>
<li><strong>Sample</strong>,对所有trajectory（路径）的期望reward（求和求平均）</li>
</ul>
</li>
<li>choose best actor : Gradient Ascent</li>
</ol>
<ul>
<li>6.1 Problem Statement:<script type="math/tex; mode=display">\theta^\star=argmax_\theta \overline{R}_\theta</script><script type="math/tex; mode=display">
\overline{R}_\theta=\sum_{\tau}R(\tau)P(\tau|\theta)</script></li>
<li>6.2 Gradient ascent:<ul>
<li>start with $\theta^0$</li>
<li>$\theta^1 \leftarrow \theta^0 + \eta\nabla\overline{R}_{\theta^0}$</li>
<li>$\theta^2 \leftarrow \theta^1 + \eta\nabla\overline{R}_{\theta^1}$</li>
<li>。。。</li>
<li>$\theta=\{w_1,w_2,w_3,…\}$</li>
<li>$\nabla\overline{R}_{\theta}=\left[\begin{matrix}<br>\partial\overline{R}_{\theta}/\partial w_1 \\<br>\partial\overline{R}_{\theta}/\partial w_2\\<br>…\\<br>\partial\overline{R}_{\theta}/\partial w_n<br>…<br>\end{matrix}<br>\right]$</li>
<li><strong>_IMPORTANT EQUATION NO. 2_</strong> (come from  <strong>_IMPORTANT EQUATION NO. 1_</strong>):</li>
<li><img src="/pic/Gradient_Ascent.JPG" alt="Pic" title="DRL_structure"></li>
<li>推导得：$\nabla\overline{R}_{\theta}\approx\frac{1}{N}\sum_{n=1}^{N}R(\tau^n)\nabla logP(\tau|\theta )$</li>
<li>问题化为计算$\nabla logP(\tau|\theta )$<h4 id="计算-nabla-logP-tau-theta"><a href="#计算-nabla-logP-tau-theta" class="headerlink" title="计算 $\nabla logP(\tau|\theta )$"></a>计算 $\nabla logP(\tau|\theta )$</h4></li>
<li>$\tau=\{s_1,a_1,r_1,s_2,a_2,r_2,…s_T,a_T,r_T \}$</li>
<li><img src="/pic/dlog.JPG" alt="Pic_dlog" title="dlog"></li>
<li>公式含义（游戏为例）：$\theta$下采取$\tau$路径的概率 = 第一画面为s1的概率<em>（s1,$\theta$）下采取a1动作的概率</em>(s1,a1)下转移到s2动作并获得r1奖励的概率*。。。</li>
<li>取log，乘变加，对$\theta$微分，忽略无关部分</li>
<li><img src="/pic/dlog2.JPG" alt="Pic_dlog2" title="dlog"></li>
<li>so，结合之前，可得到：<img src="/pic/dlog3.JPG" alt="Pic_dlog2" title="dlog"></li>
<li>注意：公式中，p概率是在时间t下的状态s和动作a，但是reward R是全过程的值；理解为有些动作不会产生reward，但是会对全局reward产生影响</li>
<li>注意2：为什么取log？<img src="/pic/dlog4.JPG" alt="Pic_dlog2" title="dlog"><ul>
<li>即是dp/p，相当于做了normalization，去除概率大小本身的影响，只考虑变化</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>Tips<ul>
<li><ol>
<li>Add a baseline: 防止没sample到的action的概率减少<br><img src="/pic/dlog5.JPG" alt="Pic_dlog2" title="dlog"></li>
</ol>
</li>
<li><ol>
<li>Assigne Suitable Credit 加weight<br><img src="/pic/Tip2.JPG" alt="Pic_dlog2" title="dlog"></li>
</ol>
</li>
<li>只取动作之后的reward，并且按时间远近做discount，$\gamma$, 即遗忘因子</li>
<li>Advantage Function: $A^{\theta}\left(s_{t}, a_{t}\right)$=$R\left(\tau^{n}\right)$</li>
</ul>
</li>
</ol>
<h2 id="2-Proximal-Policy-Optimization-PPO"><a href="#2-Proximal-Policy-Optimization-PPO" class="headerlink" title="2. Proximal Policy Optimization (PPO)"></a>2. Proximal Policy Optimization (PPO)</h2><p><a href="https://www.bilibili.com/video/av24724071/?p=2" target="_blank" rel="noopener">https://www.bilibili.com/video/av24724071/?p=2</a></p>
<ol>
<li>On-plicy -&gt; off-policy</li>
<li>PPO:<ul>
<li>(1) $J_{P P O}^{\theta^{\prime}}(\theta)=J^{\theta^{\prime}}(\theta)-\beta K L\left(\theta, \theta^{\prime}\right)$</li>
<li>(2) $J^{\theta^{\prime}}(\theta)=E_{\left(s_{t}, a_{t}\right) \sim \pi_{\theta^{\prime}}}\left[\frac{p_{\theta}\left(a_{t} | s_{t}\right)}{p_{\theta^{\prime}}\left(a_{t} | s_{t}\right)} A^{\theta^{\prime}}\left(s_{t}, a_{t}\right)\right]$</li>
<li>(3) $\nabla f(x)=f(x) \nabla \log f(x)$</li>
</ul>
</li>
<li>解释：(1)为PPO,在J上加入两个分布的KL散度，使两个分布接近；(2) 为off-policy公式，通过$\theta^{\prime}$来得到$\theta$; (3)为f和df的公式</li>
<li>注意：$\beta K L\left(\theta, \theta^{\prime}\right)$ 不是参数距离，而是action的距离。是output的action distribution的距离。</li>
<li>PPO2: <script type="math/tex; mode=display">
J_{P P O 2}^{\theta^{k}}(\theta) \approx \sum_{\left(s_{t}, a_{t}\right)} \min \left(\frac{p_{\theta}\left(a_{t} | s_{t}\right)}{p_{\theta^{k}}\left(a_{t} | s_{t}\right)} A^{\theta^{k}}\left(s_{t}, a_{t}\right)\right.,
\operatorname{clip}\left(\frac{p_{\theta}\left(a_{t} | s_{t}\right)}{p_{\theta^{k}}\left(a_{t} | s_{t}\right)}, 1-\varepsilon, 1+\varepsilon\right) A^{\theta^{k}}\left(s_{t}, a_{t}\right) )</script></li>
</ol>
<h2 id="3-Q-Learning"><a href="#3-Q-Learning" class="headerlink" title="3. Q-Learning"></a>3. Q-Learning</h2><ol>
<li>训练critic</li>
<li>how to estimate V(s)<ul>
<li>$V^\pi(s)$ 是s状态之后按照$\pi$策略所有reward的期望</li>
<li>Monte-Carlo (MC) based approach：<ul>
<li>看很多state，玩到游戏结束，获得在这些state之后的V，然后成为 _回归问题_</li>
</ul>
</li>
<li>Temporal-difference(TD) approach<ul>
<li>前后两个s，a 的 V 做差得到 $r_t$</li>
</ul>
</li>
</ul>
</li>
<li><p>Another Critic: <strong>Q function</strong></p>
<ul>
<li>State-action value function $Q^\pi(s,a)$</li>
<li>Q function强制使用a at state s when using actor $\pi$；对比：V function只考虑state s and use action a in actor $\pi$</li>
<li>再解释一遍：V function，计算在状态s以后，使用$\pi$策略的reward； Q function，计算在状态s和使用a动作（这一次不一定按照$\pi$策略）后，后面全部采用$\pi$策略得到的reward</li>
<li>learn Q，然后找new pi</li>
<li>一定可以找到比$\pi$好的$\pi’$<script type="math/tex; mode=display">\pi^{\prime}(s)=\arg \max _{a} Q^{\pi}(s, a)</script></li>
<li>解释：在$\pi$策略下改变a，穷举所有a使得Q最大，则新的a就是$\pi’$</li>
</ul>
<p><img src="/pic/Q_learning.JPG" alt="Q_learning" title="Q_learning"></p>
</li>
</ol>
<h2 id="4-Tips"><a href="#4-Tips" class="headerlink" title="4. Tips"></a>4. Tips</h2><h3 id="4-1-Double-DQN"><a href="#4-1-Double-DQN" class="headerlink" title="4.1. Double DQN"></a>4.1. Double DQN</h3><ol>
<li>Q value is usually over estimated</li>
<li>Double DQN: two functions Q and Q’</li>
<li>用真正 Q 选(提案) action，用target Q 执行计算Q value<h3 id="4-2-Dueling-DQN"><a href="#4-2-Dueling-DQN" class="headerlink" title="4.2. Dueling DQN"></a>4.2. Dueling DQN</h3></li>
<li>改network 架构</li>
<li>不直接输出Q value，而是：1）V(s);2) A(s,a);求和<h3 id="4-3-Prioritized-Reply"><a href="#4-3-Prioritized-Reply" class="headerlink" title="4.3. Prioritized Reply"></a>4.3. Prioritized Reply</h3><h3 id="4-4-Multi-step"><a href="#4-4-Multi-step" class="headerlink" title="4.4. Multi-step"></a>4.4. Multi-step</h3></li>
<li>Balance between MC and TD</li>
<li>N个step以后的reward（既不是只有一个，也不是后面全部）<h3 id="4-5-Noisy-Net"><a href="#4-5-Noisy-Net" class="headerlink" title="4.5. Noisy Net"></a>4.5. Noisy Net</h3></li>
<li>Noise on Action(Epsilon Greedy)</li>
<li>Noise on Parameters: 参数加高斯noise，在episode开始添加noise，然后固定<h3 id="4-6-Distributional-Q-function"><a href="#4-6-Distributional-Q-function" class="headerlink" title="4.6. Distributional Q-function"></a>4.6. Distributional Q-function</h3></li>
<li>model distribution</li>
<li>原始：期望值</li>
<li>改进：把每个action拆分成多个bin,然后预测每个bin的几率。<h3 id="4-7-Rainbow-以上所有方法都用上"><a href="#4-7-Rainbow-以上所有方法都用上" class="headerlink" title="4.7. Rainbow : 以上所有方法都用上"></a>4.7. Rainbow : 以上所有方法都用上</h3></li>
</ol>
<h2 id="小总结："><a href="#小总结：" class="headerlink" title="小总结："></a>小总结：</h2><ul>
<li>Policy based, 拟合（learn）神经网络参数，即state-actor函数，目标是最大化reward，梯度优化reward函数。拟合直接得到actor。</li>
<li>value based， 就是learn（神经网络拟合）V/Q函数(即本次state之后的reward期望)，目标是最大化每一步action的reward(即两个连续state下Q函数的差)，拟合得到对action的评分。</li>
</ul>
<h2 id="5-Actor-Critic-（Asynchronous-Advantage-Actor-Critic-A3C-）"><a href="#5-Actor-Critic-（Asynchronous-Advantage-Actor-Critic-A3C-）" class="headerlink" title="5. Actor-Critic （Asynchronous Advantage Actor-Critic (A3C)）"></a>5. Actor-Critic （Asynchronous Advantage Actor-Critic (A3C)）</h2><h3 id="5-1-A2C-Advantage-Actor-Critic"><a href="#5-1-A2C-Advantage-Actor-Critic" class="headerlink" title="5.1 A2C: Advantage Actor-Critic"></a>5.1 A2C: Advantage Actor-Critic</h3><ol>
<li>advantage function:<script type="math/tex; mode=display">\nabla \overline{R}_{\theta} \approx \frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T_{n}}\left(r_{t}^{n}+V^{\pi}\left(s_{t+1}^{n}\right)-V^{\pi}\left(s_{t}^{n}\right)\right) \nabla \log p_{\theta}\left(a_{t}^{n} | s_{t}^{n}\right)</script></li>
<li>综合Policy 和 value方式，用V函数表示Policy gradient函数。</li>
<li>这样就会出现两个Network:一个actor，一个V function. 前面几层可以共用，如CNN<br><img src="/pic/A2C.JPG" alt="这是A2C" title="这是A2C"><h3 id="5-2-A3C：非同步"><a href="#5-2-A3C：非同步" class="headerlink" title="5.2 A3C：非同步"></a>5.2 A3C：非同步</h3>多个CPU同时学习，然后异步上传参数更新，覆盖原有参数<br><img src="/pic/A3C.JPG" alt="这是A3C" title="这是A3C"></li>
</ol>
<h3 id="5-3-Pathwise-Derivative-Policy-Gradient"><a href="#5-3-Pathwise-Derivative-Policy-Gradient" class="headerlink" title="5.3. Pathwise Derivative Policy Gradient"></a>5.3. Pathwise Derivative Policy Gradient</h3><ul>
<li><img src="/pic/Pathwise.JPG" alt="Pathwise" title="Pathwise"></li>
<li>说明：加一个network生成actor，输入给critic，使得Q增加。训练时fix Q，调节Actor</li>
<li><img src="/pic/Pathwise2.JPG" alt="Pathwise2" title="Pathwise2"></li>
</ul>
<h2 id="6-Sparse-Reward"><a href="#6-Sparse-Reward" class="headerlink" title="6. Sparse Reward"></a>6. Sparse Reward</h2><ol>
<li>reward shaping, need domain knowledge</li>
<li>Curiosity: ICM(intrinsic curiosity module )</li>
<li>Curriculum learning<ul>
<li>给机器学习做规划，从简单到复杂</li>
<li>Reverse Curriculum Generation:<ul>
<li>given a goal state s_g</li>
<li>sample some states close to s_g</li>
<li>start from s_1, reward R(s)</li>
<li>delete s whose reward is too large or too small (too easy or diffiicult at this moment)</li>
<li>sample s_2 from s_1, start from s_2</li>
</ul>
</li>
</ul>
</li>
<li>Hierachical Reinforcement learning</li>
</ol>
<h2 id="7-Imitation-Learning"><a href="#7-Imitation-Learning" class="headerlink" title="7. Imitation Learning"></a>7. Imitation Learning</h2><ol>
<li>不知道怎么制定reward，但是可以收集好的操作资料（expert），比如用真人之间的谈话来训练机器</li>
<li>Behavior Cloning.<ul>
<li>supervised learning</li>
<li>问题：observation limited</li>
<li>解决：Dataset Aggregation. <ul>
<li>采用特定$\pi$,但是收集期间expert的建议</li>
<li>用各种情况下expert的建议来学习</li>
</ul>
</li>
<li>问题2：复制无用行为</li>
</ul>
</li>
<li>Inverse Reinforcement Learning<ul>
<li>有expert的action, 反推Reward Function</li>
<li>用Reward Function重新找optimal actor</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/16/RDL_李宏毅/" data-id="cjwyaf4zt0001icukvvt7jzgs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Dynamic_Programming" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/11/Dynamic_Programming/" class="article-date">
  <time datetime="2019-06-11T12:54:19.610Z" itemprop="datePublished">2019-06-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/11/Dynamic_Programming/">Dynamic Programming</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h1><h2 id="1-Fibonacci-Sequence"><a href="#1-Fibonacci-Sequence" class="headerlink" title="1. Fibonacci Sequence"></a>1. Fibonacci Sequence</h2><ol>
<li>1,1,2,3,4,5,8,13</li>
<li>fib(n)=fib(n-1)+fib(n-2) (n!=1 or 2)</li>
<li>递归关系：overlap sub-problem</li>
<li>计算时会生成树，复杂度为O($2^n$),出现很多重复计算</li>
<li>Capture.JPG</li>
<li>出现重复计算，即重叠子问题（overlap sub-problem），保存已经算过的值</li>
<li>代码：</li>
</ol>
<ul>
<li><p>1) 简单递归 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="comment"># 终止条件 边界</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 最优子结构 状态转移公式</span></span><br><span class="line">        <span class="keyword">return</span> fab(n - <span class="number">1</span>) + fab(n - <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>2) 去掉重复运算，记录结果 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义字典</span></span><br><span class="line">dict_fab = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab_2</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="comment"># 终止条件 边界</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> dict_fab.get(n):</span><br><span class="line">    <span class="comment">#get返回指定键的值，如果值不在字典中返回default值None</span></span><br><span class="line">        print(<span class="string">'*'</span>)</span><br><span class="line">        <span class="keyword">return</span> dict_fab.get(n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 最优子结构 状态转移公式</span></span><br><span class="line">        <span class="comment"># 字典添加键值对：字典[键]=值</span></span><br><span class="line">        dict_fab[n] = fab_2(n - <span class="number">1</span>) + fab_2(n - <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> dict_fab[n]</span><br></pre></td></tr></table></figure>
</li>
<li><p>3) 动态规划算法：由前向后推</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最终优化 动态规划  （大问题化成若干相同类型的子问题 然后一个个解决子问题）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fab_3</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="comment"># 由前往后推</span></span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">        print(<span class="string">'fab(&#123;&#125;)=&#123;&#125;'</span>.format(n, b))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">2</span>):</span><br><span class="line">        print(a, b)</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">    print(<span class="string">'fab(&#123;&#125;)=&#123;&#125;'</span>.format(n, b))</span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>例题：</p>
<ol>
<li>1,2,4,1,7,8,3 数字选择，不能相邻，使求和最大<br>解：<br>上式给入数组v[0,,,n],<br>转移公式：<br>$$ OPT(n)=max\left{<br>\begin{aligned}<br>OPT(prev(n))+v(n), 选 \<br>OPT(n-1)， 不选 \<br>\end{aligned}<br>\right.$$<br>说明：</li>
</ol>
<ul>
<li>选第n个，则计算prev(n)个（不选n后可选的数）的最优解加上n的值；</li>
<li>不选第n个，则计算n-1个的最优解<br>递归出口：<br>上式子最后是opt(1)=max(v(1),opt(0));opt(0)=1</li>
</ul>
<p>代码：<strong>动态规划一般为非递归形式，在递归（从后向前）的基础上改为非递归（从前向后）</strong><br>递归法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">v=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rec_opt</span><span class="params">(v,i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> max(v[<span class="number">1</span>],rec_opt(v,<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> max(rec_opt(v,i<span class="number">-2</span>)+v[i],rec_opt(v,i<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(rec_opt(v,<span class="number">6</span>))</span><br></pre></td></tr></table></figure>

<p>非递归：自底向上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">lenth=len(v)</span><br><span class="line">opt=[<span class="number">0</span>]*len(v)</span><br><span class="line">opt[<span class="number">0</span>]=v[<span class="number">0</span>]</span><br><span class="line">opt[<span class="number">1</span>]=max(v[<span class="number">1</span>],rec_opt(v,<span class="number">0</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dp_opt</span><span class="params">(v)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,lenth):</span><br><span class="line">        A=opt[i<span class="number">-2</span>]+v[i]</span><br><span class="line">        B=opt[i<span class="number">-1</span>]</span><br><span class="line">        opt[i]= max(A, B)</span><br><span class="line">    <span class="keyword">return</span> opt[<span class="number">-1</span>]</span><br><span class="line">print(dp_opt(v))</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/11/Dynamic_Programming/" data-id="cjwyaf4z70000icuk720wp82i" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-git" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/09/git/" class="article-date">
  <time datetime="2019-06-09T12:48:53.850Z" itemprop="datePublished">2019-06-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/09/git/">GitHub_Learn</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="GitHub-Learn"><a href="#GitHub-Learn" class="headerlink" title="GitHub_Learn"></a>GitHub_Learn</h1><p><a href="https://git-scm.com/doc" target="_blank" rel="noopener">https://git-scm.com/doc</a><br><a href="https://www.liaoxuefeng.com/" target="_blank" rel="noopener">https://www.liaoxuefeng.com/</a><br>git bash 基本命令同linux bash命令，如ls，mkdir，rm等</p>
<h2 id="0-三个区域"><a href="#0-三个区域" class="headerlink" title="0. 三个区域"></a>0. 三个区域</h2><ul>
<li>工作区（working Directory）：简单的理解你在<strong>电脑里能看到的目录</strong>。</li>
<li>暂存区（stage）：Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。</li>
<li>版本库（Repository）：工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。<br><img src="/pic/git_3part.png" alt="Pic_dlog2" title="dlog"></li>
</ul>
<h2 id="1-创建版本库（仓库）repository"><a href="#1-创建版本库（仓库）repository" class="headerlink" title="1. 创建版本库（仓库）repository"></a>1. 创建版本库（仓库）repository</h2><ol>
<li>创建空目录，然后cd到此目录下 git init <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir learngit</span><br><span class="line">$ <span class="built_in">cd</span> learngit</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/Users/michael/learngit</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br><span class="line"></span><br><span class="line">Initialized empty Git repository <span class="keyword">in</span> /Users/michael/learngit/.git/</span><br></pre></td></tr></table></figure>
<ol>
<li>目录下创建文件，如readme.txt</li>
</ol>
<h2 id="2-文件放入仓库"><a href="#2-文件放入仓库" class="headerlink" title="2. 文件放入仓库"></a>2. 文件放入仓库</h2><p>两步</p>
<ol>
<li><p>用命令git add告诉Git，把文件添加到仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>用命令git commit告诉Git，把文件提交到仓库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -m <span class="string">"wrote a readme file"</span></span><br><span class="line">[master (root-commit) eaadf4e] wrote a readme file</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 readme.txt</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>git commit命令，-m后面输入的是本次提交的说明</p>
</li>
<li><p>为什么Git添加文件需要add，commit一共两步呢？因为commit可以一次提交很多文件，所以你可以多次add不同的文件，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add file1.txt</span><br><span class="line">$ git add file2.txt file3.txt</span><br><span class="line">$ git commit -m <span class="string">"add 3 files."</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>git add .</code>全部添加</p>
<h2 id="3-版本回退"><a href="#3-版本回退" class="headerlink" title="3. 版本回退"></a>3. 版本回退</h2><ol>
<li>git log 查看日志</li>
<li>用HEAD表示当前版本，上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100</li>
<li>git reset命令 退回上一版本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard HEAD^</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>慎用hard<br><img src="/pic/git_reset.jpg" alt="Pic_dlog2" title="dlog"></p>
<ol>
<li>回到未来版本：按照log中的版本号 <code>git reset --hard 1094a</code></li>
<li>git reflog 查看命令历史</li>
<li>git checkout其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以“一键还原”。</li>
<li>命令git rm用于从版本库删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失最近一次提交后你修改的内容。</li>
</ol>
<h2 id="4-远程仓库连接，创建远程仓库"><a href="#4-远程仓库连接，创建远程仓库" class="headerlink" title="4. 远程仓库连接，创建远程仓库"></a>4. 远程仓库连接，创建远程仓库</h2><h3 id="4-1-先有本地仓库，后连接远程仓库"><a href="#4-1-先有本地仓库，后连接远程仓库" class="headerlink" title="4.1 先有本地仓库，后连接远程仓库"></a>4.1 先有本地仓库，后连接远程仓库</h3><ol>
<li>本地版本库创建：建文件夹</li>
<li>登录github，Create a new repo，不要readme</li>
<li><p>本地连接和推送到远程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/zhangpm/git_note.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>
</li>
<li><p>origin 是远程默认名，master本地名</p>
</li>
<li>查看远程，<code>git remote (-v)</code></li>
</ol>
<h3 id="4-2-先有远程，后克隆"><a href="#4-2-先有远程，后克隆" class="headerlink" title="4.2 先有远程，后克隆"></a>4.2 先有远程，后克隆</h3><ol>
<li>github 创建新repository</li>
<li>clone or download 复制地址（http或ssh）“<a href="https://github.com/zhangpm/New_try.git”" target="_blank" rel="noopener">https://github.com/zhangpm/New_try.git”</a></li>
<li>git clone <a href="https://github.com/zhangpm/New_try.git" target="_blank" rel="noopener">https://github.com/zhangpm/New_try.git</a></li>
</ol>
<h2 id="5-分支"><a href="#5-分支" class="headerlink" title="5. 分支"></a>5. 分支</h2><h3 id="5-1-查看"><a href="#5-1-查看" class="headerlink" title="5.1 查看"></a>5.1 查看</h3><ol>
<li>查看分支<code>git branch</code></li>
<li>查看远程分支<code>git branch -r</code></li>
<li>查看全部分支<code>git branch -a</code></li>
<li>查看分支合并情况<code>git log --graph --pretty=oneline --abbrev-commit</code></li>
</ol>
<h3 id="5-2-添加-“dev-为分支名”"><a href="#5-2-添加-“dev-为分支名”" class="headerlink" title="5.2 添加 “dev 为分支名”"></a>5.2 添加 <strong>“dev 为分支名”</strong></h3><ol>
<li>创建本地分支<code>git branch dev</code></li>
<li>切换到新创建的分支<code>git checkout dev</code>切换后，文件中的目录即检出未当前分支下的内容</li>
<li>在当前分支下add 和commit文件</li>
<li>将新分支push到github<code>git push origin dev</code></li>
<li>**<code>git checkout -b dev</code>  -b参数表示创建并切换，相当于git branch dev + git checkout dev</li>
</ol>
<h3 id="5-3-删除"><a href="#5-3-删除" class="headerlink" title="5.3 删除"></a>5.3 删除</h3><ol>
<li>删除本地：<code>git branch -d dev</code></li>
<li>未合并强制删除：<code>git branch -D dev</code></li>
<li>删除远程分支<code>git push origin --delete dev</code></li>
</ol>
<h3 id="5-3-5-本地和远程分支的各种关联增删总结"><a href="#5-3-5-本地和远程分支的各种关联增删总结" class="headerlink" title="5.3.5 本地和远程分支的各种关联增删总结"></a>5.3.5 本地和远程分支的各种关联增删总结</h3><ol>
<li>远程仓库有master 和dev 分支，要拉到本地<ul>
<li><code>git clone XXX</code>,克隆后本地master 和远程origin/master默认关联，但是dev默认不关联</li>
<li><code>git checkout -b dev origin/dev</code>本地创建dev，关联origin/dev</li>
<li>上述语句等同于<code>git checkout -b dev</code>+<code>git pull origin dev</code>??</li>
</ul>
</li>
<li>远程仓库只有master，本地分支push到远程<ul>
<li><code>git push origin dev</code></li>
</ul>
</li>
<li>建立本地分支后，关联远程分支：<ul>
<li><code>git branch --set-upstream-to=origin/remote_branch  your_branch</code></li>
<li>eg. <code>git branch --set-upstream-to=origin/dev dev</code><br>其中，origin/remote_branch是你本地分支对应的远程分支；your_branch是你当前的本地分支。</li>
</ul>
</li>
</ol>
<h3 id="5-4-合并分支"><a href="#5-4-合并分支" class="headerlink" title="5.4 合并分支"></a>5.4 合并分支</h3><ol>
<li>git merge dev</li>
<li>合并成功是fast foward 模式，合并后无分支记录</li>
<li>合并的两个分支同时改动同一位置，会产生合并冲突，先解决冲突，在文件中修改后，add，commit，然后即合并完成，可删除分支</li>
<li>no-ff 非fast foward模式，合并后有分支记录<code>git merge --no-ff -m &quot;merge with no-ff&quot; dev</code></li>
</ol>
<h3 id="5-5-分支策略"><a href="#5-5-分支策略" class="headerlink" title="5.5 分支策略"></a>5.5 分支策略</h3><ol>
<li>master 应为稳定版，平时不在上面干活</li>
<li>在dev分支上干活，发布版本时merge到master上</li>
<li>各部分工作各做分支，先合并到dev，再合并到master</li>
</ol>
<h3 id="5-6-保持工作状态stash"><a href="#5-6-保持工作状态stash" class="headerlink" title="5.6 保持工作状态stash"></a>5.6 保持工作状态stash</h3><p>应用: 工作一半，不想提交，但是要去作别的</p>
<ol>
<li>保存现场<code>git stash</code></li>
<li>查看保存<code>git stash list</code></li>
<li>恢复现场：<ul>
<li>恢复<code>git stash apply</code>，删除记录 <code>git slash drop</code></li>
<li>恢复并删除记录<code>git stash pop</code></li>
</ul>
</li>
</ol>
<h3 id="5-7-分支远程推送策略："><a href="#5-7-分支远程推送策略：" class="headerlink" title="5.7 分支远程推送策略："></a>5.7 分支远程推送策略：</h3><ol>
<li>远程推送：<code>git push origin dev</code></li>
<li>策略：<ul>
<li>master 推送，保持同步</li>
<li>dev 开发分支（develop），保持同步</li>
<li>bug分支，本地修复，无需推送到远程</li>
<li>feature，视情况而定<br>总之，就是在Git中，分支完全可以在本地自己藏着玩，是否推送，视你的心情而定！</li>
</ul>
</li>
</ol>
<h2 id="6-多人协作"><a href="#6-多人协作" class="headerlink" title="6. 多人协作"></a>6. 多人协作</h2><ol>
<li>首先，可以试图用git push origin \<branch-name>推送自己的修改</branch-name></li>
<li>若失败，则git pull先拉取最新版本。</li>
<li>pull 中会merge本地和拉下来的版本，容易产生冲突，需要手动解决，然后add，commit</li>
<li>没有冲突或者解决掉冲突后，再用git push origin \<branch-name>推送就能成功</branch-name></li>
<li>如果git pull提示no tracking information，则说明本地分支和远程分支的链接关系没有创建，用命令git branch —set-upstream-to <branch-name> origin/<branch-name></branch-name></branch-name></li>
</ol>
<h2 id="7-tag标签"><a href="#7-tag标签" class="headerlink" title="7. tag标签"></a>7. tag标签</h2><ol>
<li><code>git tag v1.0</code>当前commit打标签“v1.0”</li>
<li><code>git tag</code>查看全部标签</li>
<li><code>git tag v0.9 f52c633</code>给commit号为f…打标签v0.9</li>
<li>commit id 号查看：<code>git log --pretty=oneline --abbrev-commit</code></li>
<li><code>git tag -a v0.1 -m &quot;version 0.1 released&quot; 1094adb</code> -m 添加说明</li>
<li><code>git show v0.1</code> 显示说明</li>
<li>标签总是和某个commit挂钩</li>
<li><code>git tag -d v0.1</code>删除标签</li>
<li><code>git push origin v1.0</code>标签推送到远程</li>
<li><code>git push origin --tags</code>全部标签推送</li>
<li>删除已推送的标签：先删本地<code>git tag -d v0.1</code>，再<code>git push origin :refs/tags/&lt;tagname&gt;</code>,登录github查看删除结果</li>
</ol>
<h2 id="8-参与（下载）开源项目"><a href="#8-参与（下载）开源项目" class="headerlink" title="8. 参与（下载）开源项目"></a>8. 参与（下载）开源项目</h2><ol>
<li>在GitHub上，可以任意Fork开源仓库；</li>
<li>clone到本地</li>
<li>自己随便用，push到自己的仓库</li>
<li>参与开源，则发起pull request，等待原作者审核通过</li>
</ol>
<p>—End—</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/09/git/" data-id="cjwoy2uxk00002oukhs2t6wc4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hexo_gitpage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/09/hexo_gitpage/" class="article-date">
  <time datetime="2019-06-09T12:27:29.547Z" itemprop="datePublished">2019-06-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/09/hexo_gitpage/">Hexo + GitHub 个人主页</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h2><ol>
<li>node.js</li>
<li>git,github账号</li>
<li>新建文件夹blog，在文件夹下右键-git bash</li>
<li>安装hexo：npm install -g hexo-cli</li>
<li>输入：hexo init; npm install； npm install hexo-deployer-git —save</li>
<li>进入github网站，新建repository,”name”填写“用户名.github.io”，例如“pengmiao.github.io”</li>
<li>生成repository，复制ssh或http地址</li>
<li><p>到blog文件夹下找到_config.yml,打开，在最后修改和添加：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">git@github.com:zhangpm/pengmiao.github.io.git</span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>即部署到git, <strong>重要</strong><br><code>hexo g -d</code>,</p>
</li>
<li>打开网页：<a href="https://zhangpm.github.io/" target="_blank" rel="noopener">https://zhangpm.github.io/</a><h2 id="2-更新和添加博客"><a href="#2-更新和添加博客" class="headerlink" title="2. 更新和添加博客"></a>2. 更新和添加博客</h2></li>
<li>在文件夹下G:\git\blog\source_posts 添加markdown文件</li>
<li>部署博客“hexo g -d”</li>
</ol>
<h2 id="3-更换主题"><a href="#3-更换主题" class="headerlink" title="3. 更换主题"></a>3. 更换主题</h2><ol>
<li>Hexo官网，themes，找主题</li>
<li>在blog目录下按照安装说明操作,一般会修改blog下的config（不是主题下）</li>
<li>在所用主题的目录下找config.yml，修改图片和名字</li>
</ol>
<h2 id="4-渲染数学公式"><a href="#4-渲染数学公式" class="headerlink" title="4. 渲染数学公式"></a>4. 渲染数学公式</h2><p><a href="https://www.jianshu.com/p/7ab21c7f0674" target="_blank" rel="noopener">https://www.jianshu.com/p/7ab21c7f0674</a></p>
<h2 id="5-图片处理"><a href="#5-图片处理" class="headerlink" title="5. 图片处理"></a>5. 图片处理</h2><ol>
<li>CMD连接文件夹：mklink G:\git\blog\source_posts\pic G:\git\blog\source\pic</li>
<li>markdown中写入/pic/图片，本机取_posts\pic，远程取\source\pic，内容一样，均可显示</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/09/hexo_gitpage/" data-id="cjwoxanl70000rwuko4os7sbg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/09/hello-world/" class="article-date">
  <time datetime="2019-06-09T10:07:58.465Z" itemprop="datePublished">2019-06-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/09/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/06/09/hello-world/" data-id="cjwosgzn10000lkukyat2wzpq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/02/Linux_shell/">Linux Shell</a>
          </li>
        
          <li>
            <a href="/2019/06/23/Linux_web/">Linux Web</a>
          </li>
        
          <li>
            <a href="/2019/06/20/A_Cooperative_Multi-Agent_DRL/">A Cooperative Multi-Agent Deep Reinforcement Learning Framework for Real-Time Residential Load Scheduling</a>
          </li>
        
          <li>
            <a href="/2019/06/17/Linux_note/">Linux Note</a>
          </li>
        
          <li>
            <a href="/2019/06/16/RDL_李宏毅/">RDL_李宏毅</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->

</body>
</html>